●NAKOワーカー

NAKOワーカーは、HTML5のWebWorkerをなでしこで実装したものです。WebWorker（以後ワーカーと略します）を使うとブラウザのレンダリングを行うメインスレッドとは異なる別のスレッドにて計算処理を行うことができます。処理に時間がかかる場合にワーカーを使うと、ユーザー操作を妨げることなく処理を行えます。

●NAKOワーカーの使い方

ワーカーを使う基本的な流れは以下の手順の通りです。

・(1) NAKOワーカーオブジェクトを作成
・(2) ワーカー側になでしこの関数を転送
・(3) ワーカーのプログラムを起動
・(4) ワーカーとメインスレッドでデータを送受信することで処理を進める

なお、メインスレッド側、ワーカー側、双方にデータを受信するイベントを定義する必要があります。

以下のプログラムは、NAKOワーカーを使って、足し算を行うだけのプログラムです。

{{{#nako3(rows=15)
# --- メインスレッド ---
# (1) ワーカーの利用準備
NAKOワーカー起動して、Wに代入。

# (2) ワーカーからデータを受信した時のイベントを定義
WからNAKOワーカーデータ受信した時には
　　受信データ["結果"]を表示。
ここまで

# (3) ワーカーに頼みたい仕事を記述した関数を文字列で指定
[「ワーカー初期化」,「加算処理」]をWにNAKOワーカー転送。

# (4) ワーカー側に転送した処理を起動
Wで「ワーカー初期化」をNAKOワーカープログラム起動。

# (5) ワーカーにデータを送信する
{A:30, B:50}をWにNAKOワーカーデータ送信。

# --- ワーカーでの処理 ---
●ワーカー初期化とは
　　NAKOワーカーデータ受信した時には
　　　　A=受信データ["A"]
　　　　B=受信データ["B"]
　　　　AとBを加算処理してCに代入。
　　　　{"結果": C}をNAKOワーカーデータ送信。
　　ここまで。
ここまで

●(AとBを)加算処理とは
　　AとBを足すこと。
ここまで
}}}

●参考

- [[plugin_webworker]] --- NAKOワーカーの命令群
- [[なでしこ貯蔵庫/WebWorker2段構成テスト:https://nadesi.com/v3/storage/id.php?497]]
- [[なでしこ貯蔵庫/リバーシ(マルチスレッド版):https://nadesi.com/v3/storage/id.php?493]]




